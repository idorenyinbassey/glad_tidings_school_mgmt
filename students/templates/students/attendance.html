{% extends 'core/base.html' %}
{% load static %}

{% block title %}Attendance{% endblock %}

{% block extra_css %}
<style>
  .card {
    background: #fff;
    border-radius: 10px;
    padding: 24px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.08);
  }
  .stat {
    text-align: center;
  }
  .stat h3 { margin-bottom: 0; }
  .badge-present { background-color: #28a745; }
  .badge-absent { background-color: #dc3545; }
  .filter-label { font-weight: 600; }
  .form-inline .form-control { width: auto; }
  .table-responsive { border-radius: 10px; overflow: hidden; }
  .muted { color: #6c757d; }
  .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; }
  .btn-outline-secondary { border-radius: 6px; }
  .page-header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 16px; }
  .page-header h1 { margin: 0; }
  .filters .form-group { margin-right: 10px; }
  @media (max-width: 576px) {
    .page-header { flex-direction: column; align-items: flex-start; gap: 8px; }
  }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="page-header">
    <h1 class="h3">üóìÔ∏è Attendance</h1>
    <a href="{% url 'students:student_home' %}" class="btn btn-outline-secondary btn-sm"><i class="fas fa-arrow-left"></i> Back</a>
  </div>

  <div class="card mb-4">
    <form method="get" class="form-inline filters">
      <div class="form-group mr-3 mb-2">
        <label class="filter-label mr-2" for="start_date">From</label>
        <input type="date" class="form-control" id="start_date" name="start_date" value="{{ start_date }}">
      </div>
      <div class="form-group mr-3 mb-2">
        <label class="filter-label mr-2" for="end_date">To</label>
        <input type="date" class="form-control" id="end_date" name="end_date" value="{{ end_date }}">
      </div>
      <button type="submit" class="btn btn-primary mb-2"><i class="fas fa-filter"></i> Apply</button>
      <a href="{% url 'students:attendance' %}" class="btn btn-outline-secondary mb-2 ml-2">Reset</a>
    </form>
  </div>

  <div class="row mb-4">
    <div class="col-md-3 col-6 mb-3">
      <div class="card stat">
        <div class="muted">Total Days</div>
        <h3>{{ total_days }}</h3>
      </div>
    </div>
    <div class="col-md-3 col-6 mb-3">
      <div class="card stat">
        <div class="muted">Present</div>
        <h3>{{ days_present }}</h3>
      </div>
    </div>
    <div class="col-md-3 col-6 mb-3">
      <div class="card stat">
        <div class="muted">Absent</div>
        <h3>{{ days_absent }}</h3>
      </div>
    </div>
    <div class="col-md-3 col-6 mb-3">
      <div class="card stat">
        <div class="muted">Attendance %</div>
        <h3>{{ attendance_percent }}%</h3>
      </div>
    </div>
  </div>

  <div class="card">
    {% if records %}
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="thead-light">
            <tr>
              <th style="width: 200px;">Date</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for rec in records %}
            <tr>
              <td>{{ rec.date|date:"M d, Y" }}</td>
              <td>
                {% if rec.present %}
                <span class="badge badge-present">Present</span>
                {% else %}
                <span class="badge badge-absent">Absent</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-center py-4 text-muted">
        <i class="far fa-calendar-times fa-2x mb-2"></i>
        <div>No attendance records found for the selected period.</div>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
